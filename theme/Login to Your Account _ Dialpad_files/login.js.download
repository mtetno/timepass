define(["jquery","underscore","email","mutation_observer"],function(e,k,d,c){var g=function(){e("#login-namepass input").on("focus",i);e("#login-namepass").on("submit",l);e("#login-namepass #submit-btn").on("click",l);e("input").on("input",j);c.watch("input[type=password]",function(){j();});j();};var h=function(){var m=e("#submit-btn");if(m.hasClass("disabled")){return;}m.addClass("disabled");e.ajax("/api/auth/client",{data:JSON.stringify({email:e("#email").val(),password:e("#password").val(),action:"ajax","g-recaptcha-response":grecaptcha.getResponse()}),dataType:"json",contentType:"application/json",type:"post",success:a,error:b,});};var f=function(o){var m=e(o.currentTarget);var n=m.find('input[type="submit"]');n.prop("disabled",true);n.addClass("disabled");};var l=function(m){m.preventDefault();grecaptcha.execute();};var i=function(m){e("#login-namepass").removeClass("error");};var a=function(m){return document.location.href=m.continue_url;};var b=function(m){response=m.responseText?JSON.parse(m.responseText):{};if(response.redirect_url){return document.location.href=response.redirect_url;}e("#login-namepass").addClass("error");grecaptcha.reset();};var j=function(s){var u=false;var r=false;var m=e("input");for(var p=0;p<m.length;p++){var v=e(m[0]);if(!v.val().trim()){u=true;}}var t=e("#email");if(t.length){var o=t.val();u=u||!d.isEmail(o);}var q=e("#password");if(q.length){r=q.val().length<6;}var x=e("#confirm-password");if(x.length){r=r||x.val()!=e("#password").val();r=r||x.val().length<6;if(q.val().length||x.val().length){e("#password-error").toggleClass("hidden",!r);}}var n=e("#submit-btn");n.toggleClass("disabled",u||r);var w=e('input[type="submit"]');w.prop("disabled",u||r);};return{initialize:g,onLogin:h,};});